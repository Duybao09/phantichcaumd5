<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DUY BẢO TOOL V28.6</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <style>
    body {
      background: #000;
      color: #00fff7;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 30px 10px;
    }
    input, button, select {
      padding: 12px;
      margin: 10px auto;
      font-size: 16px;
      width: 90%;
      max-width: 400px;
      border-radius: 8px;
      border: none;
    }
    button {
      background: #00fff7;
      color: black;
      font-weight: bold;
      cursor: pointer;
    }
    .hidden { display: none; }
  </style>
</head>
<body>

<!-- Đăng ký -->
<div id="registerBox">
  <h2>ĐĂNG KÝ KEY TRUY CẬP</h2>
  <input type="email" id="regEmail" placeholder="Nhập Gmail của bạn">
  <button onclick="dangKy()">Gửi yêu cầu đăng ký</button>
  <a href="t.me/ngoclinh2809" target="_blank">
    <button style="margin-top:5px;">Liên hệ Admin</button>
  </a>
  <p id="regMsg" style="color: orange;"></p>
</div>

<!-- Đăng nhập -->
<div id="loginBox">
  <h2>ĐĂNG NHẬP TOOL</h2>
  <input type="email" id="gmail" placeholder="Gmail đã đăng ký">
  <input type="text" id="key" placeholder="Nhập Key được cấp">
  <button onclick="kiemTraKey()">Vào Tool</button>
  <p id="msg" style="color: red;"></p>
</div>

<!-- TOOL -->
<div id="toolBox" class="hidden">
  <h2>DUY BẢO TOOL DỰ ĐOÁN ALL GAME</h2>
  <select id="gameSelect">
    <option value="hit">Hit.club</option>
    <option value="sum">Sum.club</option>
    <option value="b52">B52.cc</option>
    <option value="789">789.club</option>
  </select>
  <input type="text" id="md5Input" placeholder="Nhập mã MD5...">
  <button onclick="duDoan()">DỰ ĐOÁN</button>
  <div id="result">Kết quả sẽ hiển thị tại đây</div>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDV-WnnRBzNGaJjCmJMY7NOWEPFioHOioU",
    authDomain: "duybao-v11.firebaseapp.com",
    databaseURL: "https://duybao-v11-default-rtdb.firebaseio.com",
    projectId: "duybao-v11"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function dangKy() {
    const gmail = document.getElementById("regEmail").value.trim();
    if (!gmail.includes("@")) {
      document.getElementById("regMsg").innerText = "Vui lòng nhập Gmail hợp lệ.";
      return;
    }
    const data = {
      gmail: gmail,
      time: new Date().toLocaleString()
    };
    db.ref("dangky").push(data);
    document.getElementById("regMsg").innerText = "Đã gửi yêu cầu, chờ admin duyệt.";
  }

  async function kiemTraKey() {
    const gmail = document.getElementById("gmail").value.trim();
    const key = document.getElementById("key").value.trim();
    const msg = document.getElementById("msg");

    const snap = await db.ref("keys/" + key).get();
    if (!snap.exists()) {
      msg.innerText = "Key không tồn tại!";
      return;
    }

    const data = snap.val();
    const now = new Date();
    if (data.email !== gmail) {
      msg.innerText = "Sai Gmail được cấp!";
    } else if (data.expire && data.expire !== "forever" && new Date(data.expire) < now) {
      msg.innerText = "Key đã hết hạn!";
    } else if (data.used >= data.maxUse) {
      msg.innerText = "Key vượt giới hạn!";
    } else {
      await db.ref("keys/" + key + "/used").set((data.used || 0) + 1);
      db.ref("logs").push({ gmail, key, time: now.toLocaleString() });
      document.getElementById("loginBox").classList.add("hidden");
      document.getElementById("registerBox").classList.add("hidden");
      document.getElementById("toolBox").classList.remove("hidden");
    }
  }

  function duDoan() {
    const md5 = document.getElementById("md5Input").value.trim();
    const game = document.getElementById("gameSelect").value;
    if (md5.length < 6) {
      document.getElementById("result").innerText = "MD5 không hợp lệ!";
      return;
    }

    const last6 = md5.slice(-6);
    const num = parseInt(last6, 16);
    let d1, d2, d3;

    if (game === "hit") {
      d1 = (num % 6) + 1;
      d2 = (Math.floor(num / 6) % 6) + 1;
      d3 = (Math.floor(num / 36) % 6) + 1;
    } else if (game === "sum") {
      d1 = (num % 5) + 2;
      d2 = (Math.floor(num / 7) % 6) + 1;
      d3 = (Math.floor(num / 49) % 6) + 1;
    } else if (game === "b52") {
      d1 = (num % 6) + 1;
      d2 = (Math.floor(num / 8) % 6) + 1;
      d3 = (Math.floor(num / 64) % 6) + 1;
    } else if (game === "789") {
      d1 = (num % 6) + 1;
      d2 = (Math.floor(num / 11) % 6) + 1;
      d3 = (Math.floor(num / 121) % 6) + 1;
    }

    const sum = d1 + d2 + d3;
    const result = sum >= 11 ? "TÀI" : "XỈU";
    document.getElementById("result").innerText = `KẾT QUẢ: ${result}`;
  }
</script>

</body>
</html>